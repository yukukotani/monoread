# 実装計画

- [ ] 1. llms.txt URL生成ユーティリティの実装
  - `generateLlmsTxtUrl`関数を作成
  - URLパース、search params・hashの除去、パス正規化を実装
  - _要件: 1.1, 1.2_

- [ ] 2. readability結果検証ユーティリティの実装
  - `isReadabilityResultEmpty`関数を作成
  - 空文字列、ホワイトスペースのみのコンテンツを検出
  - _要件: 3.1, 3.2, 3.3_

- [ ] 3. llms.txtコンテンツ抽出機能の実装
- [ ] 3.1 llms.txtコンテンツ検証ユーティリティを作成

  - `isValidLlmsTxtContent`関数を実装
  - コンテンツの基本的な検証ロジックを作成
  - _要件: 4.2_

- [ ] 3.2 llms.txt抽出ユーティリティのコア機能を実装

  - `extractContentFromLlmsTxt`関数を作成
  - llms.txt URL生成、HTTPリクエスト、コンテンツ返却を実装
  - _要件: 1.1, 1.2, 4.1, 4.3, 4.4_

- [ ] 4. content-extractor.tsのフォールバック処理を修正
  - 既存のreadability処理をラップしてContentResult形式に変換
  - readability失敗時のllms.txtフォールバックを追加
  - 適切なログ出力を実装
  - _要件: 2.1, 2.2, 2.3, 2.4, 2.5_

- [ ] 5. 単体テストの実装
- [ ] 5.1 URL生成ユーティリティのテストを作成

  - 基本的なURL変換、search params/hash除去、パス処理のテスト
  - 無効なURLのハンドリングテスト
  - _要件: 1.1, 1.2_

- [ ] 5.2 readability結果検証のテストを作成

  - 空文字列、ホワイトスペースのみ、有効なコンテンツの判定テスト
  - _要件: 3.1, 3.2, 3.3_

- [ ] 5.3 llms.txt抽出機能のテストを作成

  - 成功ケース：正常なllms.txtコンテンツの取得
  - 失敗ケース：404、ネットワークエラー、空コンテンツ
  - _要件: 1.3, 1.4, 4.1, 4.2, 5.1, 5.2, 5.3, 5.4_

- [ ] 6. 統合テストの実装
  - フォールバック順序のテスト：readability成功時の動作
  - フォールバック順序のテスト：readability失敗時のllms.txtフォールバック
  - エラーケース：両方が失敗した場合の動作
  - _要件: 2.1, 2.2, 2.3, 2.4, 2.5_

- [ ] 7. エッジケーステストの実装
  - 大きなファイル、HTMLタグを含むllms.txt、タイムアウトのテスト
  - 異常なURLパターンのテスト
  - _要件: 5.1, 5.2, 5.3, 5.4_

- [ ] 8. lintチェックとコミット
  - `pnpm lint`でコード品質を確認
  - 実装完了としてコミットを作成
  - _要件: 全体_